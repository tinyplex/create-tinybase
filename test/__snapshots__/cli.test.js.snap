// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`create-tinybase > js-react-basic > should match snapshot 1`] = `
{
  "README.md": "# test-js-react-basic

A TinyBase app built with JavaScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Demo</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A simple TinyBase app with key-values and tables mutated with
              buttons. See the full set of
              <a href="https://tinybase.org/demos/" target="_blank"
                >TinyBase demos</a
              >
              for more examples. <br /><br />
              Built with JavaScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.jsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-react-basic",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.jsx": "import {StrictMode} from 'react';
import {createStore} from 'tinybase';
import {Provider, useCreateStore} from 'tinybase/ui-react';
import {SortedTableInHtmlTable, ValuesInHtmlTable} from 'tinybase/ui-react-dom';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Buttons} from './Buttons';
const App = () => {
  const store = useCreateStore(() => {
    return createStore()
      .setValue('counter', 0)
      .setRow('pets', '0', {name: 'fido', species: 'dog'})
      .setTable('species', {
        dog: {price: 5},
        cat: {price: 4},
        fish: {price: 2},
        worm: {price: 1},
        parrot: {price: 3},
      });
  });
  return (
    <StrictMode>
      <Provider store={store}>
        <Buttons />
        <div>
          <h2>Values</h2>
          <ValuesInHtmlTable />
        </div>
        <div>
          <h2>Pets Table</h2>
          <SortedTableInHtmlTable
            tableId="pets"
            cellId="name"
            limit={5}
            sortOnClick={true}
            className="sortedTable"
            paginator={true}
          />
        </div>
        <Inspector />
      </Provider>
    </StrictMode>
  );
};
export {App};
",
  "src/Buttons.jsx": "import {useAddRowCallback, useSetValueCallback} from 'tinybase/ui-react';
import {Button} from './components/Button';
const getRandom = (max = 100) => Math.floor(Math.random() * max);
const Buttons = () => {
  const handleCount = useSetValueCallback(
    'counter',
    () => (value) => (value ?? 0) + 1,
  );
  const handleRandom = useSetValueCallback('random', () => getRandom());
  const handleAddPet = useAddRowCallback('pets', (_, store) => ({
    name: ['fido', 'felix', 'bubbles', 'lowly', 'polly'][getRandom(5)],
    species: store.getRowIds('species')[getRandom(5)],
  }));
  return (
    <div id="buttons">
      <Button onClick={handleCount}>Increment number</Button>
      <Button onClick={handleRandom}>Random number</Button>
      <Button onClick={handleAddPet}>Add a pet</Button>
    </div>
  );
};
export {Buttons};
",
  "src/basic.css": "#buttons {
  border: solid #666;
  border-width: 1px 0;
  text-align: center;
  padding: 1rem 0;
}

table {
  border-collapse: collapse;
  font-size: inherit;
  line-height: inherit;
  margin-top: 0.5rem;
  table-layout: fixed;
  width: 100%;
  margin-bottom: 2rem;
  caption-side: bottom;
}
table caption {
  text-align: left;
  button {
    border: 0;
    margin-right: 0.25rem;
  }
}
table caption button {
  line-height: 0.7rem;
  margin: 0 0.25rem 0 0;
  vertical-align: middle;
}
th,
td {
  padding: 0.25rem 0.5rem 0.25rem 0;
  text-align: left;
}
thead th,
thead td {
  border: solid #999;
  border-width: 1px 0;
}
tbody th,
tbody td {
  border-bottom: 1px solid #333;
}

table.sortedTable thead th {
  cursor: pointer;
}

@media (min-width: 50rem) {
  #app {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
  }
  #buttons {
    grid-column: span 2;
  }
}
",
  "src/components/Button.jsx": "import './button.css';
const Button = ({children, onClick, variant = 'default'}) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : void 0}
  >
    {children}
  </button>
);
export {Button};
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.jsx": "import './index.css';
import './basic.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';
addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')).render(<App />),
);
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > js-react-chat > should match snapshot 1`] = `
{
  "README.md": "# test-js-react-chat

A TinyBase app built with JavaScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Chat</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A real-time chat application demonstrating TinyBase's reactive
              data management.
              <br /><br />
              Built with JavaScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.jsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-react-chat",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.jsx": "import {StrictMode, useState, useMemo} from 'react';
import {createStore} from 'tinybase';
import {
  Provider,
  useCreateStore,
  useAddRowCallback,
  useRow,
  useSetValueCallback,
  useValue,
  useRowIds,
  useStore,
} from 'tinybase/ui-react';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Button} from './components/Button';
const MessageInput = () => {
  const [message, setMessage] = useState('');
  const username = useValue('username') || 'Anonymous';
  const handleSend = useAddRowCallback(
    'messages',
    () => ({
      username,
      text: message,
      timestamp: Date.now(),
    }),
    [message, username],
  );
  const onSubmit = (e) => {
    e.preventDefault();
    if (message.trim()) {
      handleSend();
      setMessage('');
    }
  };
  return (
    <form onSubmit={onSubmit} className="message-input">
      <input
        type="text"
        value={message}
        onChange={(e) => setMessage(e.target.value)}
        placeholder="Type a message..."
        autoFocus
      />
      <Button onClick={() => handleSend()} variant="primary">
        Send
      </Button>
    </form>
  );
};
const Message = ({rowId}) => {
  const row = useRow('messages', rowId);
  const time = new Date(row.timestamp).toLocaleTimeString();
  return (
    <div className="message">
      <span className="username">{row.username}:</span>
      <span className="text">{row.text}</span>
      <span className="time">{time}</span>
    </div>
  );
};
const Messages = () => {
  const store = useStore();
  const messageIds = useRowIds('messages');
  const sortedIds = useMemo(() => {
    return [...messageIds].sort((a, b) => {
      const rowA = store.getRow('messages', a);
      const rowB = store.getRow('messages', b);
      return rowA.timestamp - rowB.timestamp;
    });
  }, [messageIds, store]);
  return (
    <div className="messages">
      {sortedIds.map((id) => (
        <Message key={id} rowId={id} />
      ))}
    </div>
  );
};
const UsernameInput = () => {
  const username = useValue('username') || '';
  const handleChange = useSetValueCallback(
    'username',
    (e) => e.target.value,
    [],
  );
  return (
    <div className="username-input">
      <label>Username:</label>
      <input
        type="text"
        value={username}
        onChange={handleChange}
        placeholder="Enter your name"
      />
    </div>
  );
};
const App = () => {
  const store = useCreateStore(() => {
    return createStore()
      .setValue('username', 'User')
      .setTable('messages', {
        1: {username: 'Alice', text: 'Hello!', timestamp: Date.now() - 6e4},
        2: {username: 'Bob', text: 'Hi there!', timestamp: Date.now() - 3e4},
      });
  });
  return (
    <StrictMode>
      <Provider store={store}>
        <UsernameInput />
        <Messages />
        <MessageInput />
        <Inspector />
      </Provider>
    </StrictMode>
  );
};
export {App};
",
  "src/chat.css": ".username-input {
  margin-bottom: 1rem;
}

.username-input label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.username-input input {
  flex: 1;
  padding: 0.5rem;
  background: #222;
  border: 1px solid #666;
  border-radius: 0.25rem;
  color: #fff;
  font-family: inherit;
}

.messages {
  overflow-y: auto;
  padding: 1rem 0;
  height: 400px;
  margin-bottom: 1rem;
}

.message {
  margin-bottom: 0.75rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.message .username {
  font-weight: 800;
  color: #d81b60;
}

.message .text {
  flex: 1;
}

.message .time {
  font-size: 0.8rem;
  color: #666;
}

.message-input {
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid #666;
}

.message-input input {
  flex: 1;
  padding: 0.75rem;
  background: #222;
  border: none;
  color: #fff;
  font-family: inherit;
}
",
  "src/components/Button.jsx": "import './button.css';
const Button = ({children, onClick, variant = 'default'}) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : void 0}
  >
    {children}
  </button>
);
export {Button};
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.jsx": "import './index.css';
import './chat.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';
addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')).render(<App />),
);
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > js-react-drawing > should match snapshot 1`] = `
{
  "README.md": "# test-js-react-drawing

A TinyBase app built with JavaScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Drawing</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A collaborative drawing canvas showcasing TinyBase's state
              synchronization.
              <br /><br />
              Built with JavaScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.jsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-react-drawing",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.jsx": "import {StrictMode, useCallback, useEffect, useRef} from 'react';
import {createStore} from 'tinybase';
import {
  Provider,
  useAddRowCallback,
  useCreateStore,
  useDelTableCallback,
  useRow,
  useRowIds,
  useStore,
} from 'tinybase/ui-react';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Button} from './components/Button';
const Canvas = () => {
  const canvasRef = useRef(null);
  const isDrawing = useRef(false);
  const store = useStore();
  const strokes = useRowIds('strokes');
  const addStroke = useAddRowCallback(
    'strokes',
    (e) => {
      const canvas = canvasRef.current;
      if (!canvas) return null;
      const rect = canvas.getBoundingClientRect();
      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;
      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;
      const brush = store.getRow('settings', 'brush');
      return {
        x: clientX - rect.left,
        y: clientY - rect.top,
        color: brush.color,
        size: brush.size,
      };
    },
    [],
  );
  const draw = useCallback(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    if (!ctx) return;
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    strokes.forEach((id) => {
      const stroke = store.getRow('strokes', id);
      if (stroke) {
        ctx.fillStyle = stroke.color;
        ctx.beginPath();
        ctx.arc(stroke.x, stroke.y, stroke.size, 0, Math.PI * 2);
        ctx.fill();
      }
    });
  }, [strokes, store]);
  useEffect(() => {
    draw();
  }, [draw]);
  const handleStart = (e) => {
    isDrawing.current = true;
    addStroke(e.nativeEvent);
  };
  const handleMove = (e) => {
    if (isDrawing.current) {
      addStroke(e.nativeEvent);
    }
  };
  const handleEnd = () => {
    isDrawing.current = false;
  };
  return (
    <canvas
      ref={canvasRef}
      width={600}
      height={400}
      className="drawing-canvas"
      onMouseDown={handleStart}
      onMouseMove={handleMove}
      onMouseUp={handleEnd}
      onMouseLeave={handleEnd}
      onTouchStart={handleStart}
      onTouchMove={handleMove}
      onTouchEnd={handleEnd}
    />
  );
};
const ColorPicker = () => {
  const colors = [
    '#d81b60',
    '#1976d2',
    '#388e3c',
    '#f57c00',
    '#7b1fa2',
    '#fff',
  ];
  const store = useStore();
  const currentBrush = useRow('settings', 'brush');
  const setColor = (color) => {
    store.setRow('settings', 'brush', {...currentBrush, color});
  };
  return (
    <div className="color-picker">
      {colors.map((color) => (
        <button
          key={color}
          className="color-btn"
          style={{background: color}}
          onClick={() => setColor(color)}
        />
      ))}
    </div>
  );
};
const BrushSize = () => {
  const store = useStore();
  const currentBrush = useRow('settings', 'brush');
  const size = currentBrush.size;
  const setSize = (e) => {
    store.setRow('settings', 'brush', {
      ...currentBrush,
      size: parseInt(e.target.value),
    });
  };
  return (
    <div className="brush-size">
      <label>Size:</label>
      <input type="range" min="1" max="50" value={size} onChange={setSize} />
      <span id="brush-size-value">{size}</span>
    </div>
  );
};
const ClearButton = () => {
  const clearCanvas = useDelTableCallback('strokes');
  return (
    <Button onClick={clearCanvas} variant="primary">
      Clear
    </Button>
  );
};
const App = () => {
  const store = useCreateStore(() => {
    return createStore()
      .setRow('settings', 'brush', {color: '#d81b60', size: 5})
      .setTable('strokes', {});
  });
  return (
    <StrictMode>
      <Provider store={store}>
        <>
          <div className="drawing-controls">
            <ColorPicker />
            <BrushSize />
            <ClearButton />
          </div>
          <Canvas />
          <Inspector />
        </>
      </Provider>
    </StrictMode>
  );
};
export {App};
",
  "src/components/Button.jsx": "import './button.css';
const Button = ({children, onClick, variant = 'default'}) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : void 0}
  >
    {children}
  </button>
);
export {Button};
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/drawing.css": ".drawing-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: center;
  margin: 0 auto 1rem;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  justify-content: space-between;
  max-width: 600px;
}

.color-picker {
  display: flex;
  gap: 0;
  align-items: center;
}

.color-btn {
  width: 2rem;
  height: 2rem;
  border: 2px solid var(--border);
  border-radius: 0.25rem;
  cursor: pointer;
  transition: border-color 0.2s;
  margin: 0 0 0 0.5rem;
  padding: 0;
}

.color-btn:hover,
.color-btn.active {
  border-color: var(--accent);
}

.brush-size {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.brush-size label {
  white-space: nowrap;
}

.brush-size input {
  width: 100px;
  vertical-align: middle;
}

#brush-size-value {
  width: 2rem;
  min-width: 2rem;
  text-align: center;
  display: inline-block;
}

.drawing-canvas {
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  cursor: crosshair;
  display: block;
  touch-action: none;
  margin: 0 auto;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.jsx": "import './index.css';
import './drawing.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';
addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')).render(<App />),
);
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > js-vanilla-basic > should match snapshot 1`] = `
{
  "README.md": "# test-js-vanilla-basic

A TinyBase app built with JavaScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Demo</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A simple TinyBase app with key-values and tables mutated with
              buttons. See the full set of
              <a href="https://tinybase.org/demos/" target="_blank"
                >TinyBase demos</a
              >
              for more examples. <br /><br />
              Built with JavaScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div id="buttons"></div>
        <details open>
          <summary>Values</summary>
          <pre id="valuesJson"></pre>
        </details>
        <details open>
          <summary>Tables</summary>
          <pre id="tablesJson"></pre>
        </details>
      </div>
    </div>

    <script type="module" src="/src/index.js"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-vanilla-basic",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.js": "import {createStore} from 'tinybase';
import {createButton} from './components/button';
const updateJson = (id, content) =>
  (document.getElementById(id).innerText = JSON.stringify(content, null, 2));
const getRandom = (max = 100) => Math.floor(Math.random() * max);
const app = () => {
  const store = createStore();
  const buttonsContainer = document.getElementById('buttons');
  buttonsContainer.appendChild(
    createButton('Increment number', () =>
      store.setValue('counter', (value) => value + 1),
    ),
  );
  buttonsContainer.appendChild(
    createButton('Random number', () => store.setValue('random', getRandom())),
  );
  buttonsContainer.appendChild(
    createButton('Add a pet', () =>
      store.addRow('pets', {
        name: ['fido', 'felix', 'bubbles', 'lowly', 'polly'][getRandom(5)],
        species: store.getRowIds('species')[getRandom(5)],
      }),
    ),
  );
  store.addValuesListener(() => updateJson('valuesJson', store.getValues()));
  store.addTablesListener(() => updateJson('tablesJson', store.getTables()));
  store
    .setValue('counter', 0)
    .setRow('pets', '0', {name: 'fido', species: 'dog'})
    .setTable('species', {
      dog: {price: 5},
      cat: {price: 4},
      fish: {price: 2},
      worm: {price: 1},
      parrot: {price: 3},
    });
};
export {app};
",
  "src/basic.css": "#buttons {
  border: solid #666;
  border-width: 1px 0;
  text-align: center;
  padding: 1rem 0;
}

table {
  border-collapse: collapse;
  font-size: inherit;
  line-height: inherit;
  margin-top: 0.5rem;
  table-layout: fixed;
  width: 100%;
  margin-bottom: 2rem;
  caption-side: bottom;
}
table caption {
  text-align: left;
  button {
    border: 0;
    margin-right: 0.25rem;
  }
}
table caption button {
  line-height: 0.7rem;
  margin: 0 0.25rem 0 0;
  vertical-align: middle;
}
th,
td {
  padding: 0.25rem 0.5rem 0.25rem 0;
  text-align: left;
}
thead th,
thead td {
  border: solid #999;
  border-width: 1px 0;
}
tbody th,
tbody td {
  border-bottom: 1px solid #333;
}

table.sortedTable thead th {
  cursor: pointer;
}

@media (min-width: 50rem) {
  #app {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
  }
  #buttons {
    grid-column: span 2;
  }
}
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.js": "import './button.css';
const createButton = (text, onClick, variant = 'default') => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
export {createButton};
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.js": "import './index.css';
import './basic.css';
import {app} from './app';
addEventListener('load', app);
",
}
`;

exports[`create-tinybase > js-vanilla-chat > should match snapshot 1`] = `
{
  "README.md": "# test-js-vanilla-chat

A TinyBase app built with JavaScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Chat</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A real-time chat application demonstrating TinyBase's reactive
              data management.
              <br /><br />
              Built with JavaScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div class="username-input">
          <label>Username:</label>
          <input
            type="text"
            id="username-input"
            placeholder="Enter your name"
          />
        </div>
        <div class="messages" id="messages"></div>
        <div class="message-input">
          <input
            type="text"
            id="message-input"
            placeholder="Type a message..."
            autofocus
          />
        </div>
      </div>
    </div>

    <script type="module" src="/src/index.js"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-vanilla-chat",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.js": "import {createStore} from 'tinybase';
import {createButton} from './components/button';
const updateMessages = (store) => {
  const messages = document.getElementById('messages');
  const messageRows = store.getTable('messages');
  const sortedIds = Object.keys(messageRows).sort(
    (a, b) => messageRows[a].timestamp - messageRows[b].timestamp,
  );
  messages.innerHTML = sortedIds
    .map((id) => {
      const msg = messageRows[id];
      const time = new Date(msg.timestamp).toLocaleTimeString();
      return \`
<div class="message">
  <span class="username">\${msg.username}:</span>
  <span class="text">\${msg.text}</span>
  <span class="time">\${time}</span>
</div>
\`;
    })
    .join('');
};
const app = () => {
  const store = createStore()
    .setValue('username', 'User')
    .setTable('messages', {
      1: {username: 'Alice', text: 'Hello!', timestamp: Date.now() - 6e4},
      2: {username: 'Bob', text: 'Hi there!', timestamp: Date.now() - 3e4},
    });
  const usernameInput = document.getElementById('username-input');
  const messageInput = document.getElementById('message-input');
  usernameInput.value = store.getValue('username');
  usernameInput.addEventListener('input', () => {
    store.setValue('username', usernameInput.value);
  });
  store.addValuesListener(() => {
    usernameInput.value = store.getValue('username');
  });
  const sendMessage = () => {
    const text = messageInput.value.trim();
    if (text) {
      store.addRow('messages', {
        username: store.getValue('username'),
        text,
        timestamp: Date.now(),
      });
      messageInput.value = '';
    }
  };
  const messageInputContainer = document.querySelector('.message-input');
  const sendButton = createButton('Send', sendMessage, 'primary');
  messageInputContainer.appendChild(sendButton);
  messageInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });
  store.addTablesListener(() => updateMessages(store));
  updateMessages(store);
};
export {app};
",
  "src/chat.css": ".username-input {
  margin-bottom: 1rem;
}

.username-input label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.username-input input {
  flex: 1;
  padding: 0.5rem;
  background: #222;
  border: 1px solid #666;
  border-radius: 0.25rem;
  color: #fff;
  font-family: inherit;
}

.messages {
  overflow-y: auto;
  padding: 1rem 0;
  height: 400px;
  margin-bottom: 1rem;
}

.message {
  margin-bottom: 0.75rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.message .username {
  font-weight: 800;
  color: #d81b60;
}

.message .text {
  flex: 1;
}

.message .time {
  font-size: 0.8rem;
  color: #666;
}

.message-input {
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid #666;
}

.message-input input {
  flex: 1;
  padding: 0.75rem;
  background: #222;
  border: none;
  color: #fff;
  font-family: inherit;
}
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.js": "import './button.css';
const createButton = (text, onClick, variant = 'default') => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
export {createButton};
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.js": "import './index.css';
import './chat.css';
import {app} from './app';
addEventListener('load', app);
",
}
`;

exports[`create-tinybase > js-vanilla-drawing > should match snapshot 1`] = `
{
  "README.md": "# test-js-vanilla-drawing

A TinyBase app built with JavaScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / JavaScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Drawing</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A collaborative drawing canvas showcasing TinyBase's state
              synchronization.
              <br /><br />
              Built with JavaScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div class="drawing-controls">
          <div class="color-picker" id="color-picker"></div>
          <div class="brush-size">
            <label>Size:</label>
            <input type="range" id="brush-size" min="1" max="50" value="5" />
            <span id="brush-size-value">5</span>
          </div>
        </div>
        <canvas
          id="drawing-canvas"
          class="drawing-canvas"
          width="600"
          height="400"
        ></canvas>
      </div>
    </div>

    <script type="module" src="/src/index.js"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-js-vanilla-drawing",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.js": "import {createStore} from 'tinybase';
import {createButton} from './components/button';
const app = () => {
  const store = createStore()
    .setRow('settings', 'brush', {color: '#d81b60', size: 5})
    .setTable('strokes', {});
  const canvas = document.getElementById('drawing-canvas');
  const ctx = canvas.getContext('2d');
  let isDrawing = false;
  const draw = () => {
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    const strokes = store.getTable('strokes');
    Object.values(strokes).forEach((stroke) => {
      ctx.fillStyle = stroke.color;
      ctx.beginPath();
      ctx.arc(stroke.x, stroke.y, stroke.size, 0, Math.PI * 2);
      ctx.fill();
    });
  };
  const addStroke = (e) => {
    const rect = canvas.getBoundingClientRect();
    const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;
    const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;
    const brush = store.getRow('settings', 'brush');
    store.addRow('strokes', {
      x: clientX - rect.left,
      y: clientY - rect.top,
      color: brush.color,
      size: brush.size,
    });
  };
  canvas.addEventListener('mousedown', () => {
    isDrawing = true;
  });
  canvas.addEventListener('mouseup', () => {
    isDrawing = false;
  });
  canvas.addEventListener('mouseleave', () => {
    isDrawing = false;
  });
  canvas.addEventListener('mousemove', (e) => {
    if (isDrawing) addStroke(e);
  });
  canvas.addEventListener('touchstart', (e) => {
    isDrawing = true;
    e.preventDefault();
  });
  canvas.addEventListener('touchmove', (e) => {
    if (isDrawing) {
      addStroke(e);
      e.preventDefault();
    }
  });
  canvas.addEventListener('touchend', () => {
    isDrawing = false;
  });
  const colors = [
    '#d81b60',
    '#1976d2',
    '#388e3c',
    '#f57c00',
    '#7b1fa2',
    '#fff',
  ];
  colors.forEach((color) => {
    const btn = document.createElement('button');
    btn.className = 'color-btn';
    btn.style.background = color;
    btn.addEventListener('click', () => {
      const brush = store.getRow('settings', 'brush');
      store.setRow('settings', 'brush', {...brush, color});
    });
    document.getElementById('color-picker').appendChild(btn);
  });
  const sizeSlider = document.getElementById('brush-size');
  const sizeLabel = document.getElementById('brush-size-value');
  sizeSlider.addEventListener('input', () => {
    const brush = store.getRow('settings', 'brush');
    const size = parseInt(sizeSlider.value);
    store.setRow('settings', 'brush', {...brush, size});
    sizeLabel.textContent = \`\${size}\`;
  });
  const clearButton = createButton(
    'Clear',
    () => store.delTable('strokes'),
    'primary',
  );
  document.querySelector('.drawing-controls').appendChild(clearButton);
  store.addTablesListener(draw);
  draw();
};
export {app};
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.js": "import './button.css';
const createButton = (text, onClick, variant = 'default') => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
export {createButton};
",
  "src/drawing.css": ".drawing-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: center;
  margin: 0 auto 1rem;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  justify-content: space-between;
  max-width: 600px;
}

.color-picker {
  display: flex;
  gap: 0;
  align-items: center;
}

.color-btn {
  width: 2rem;
  height: 2rem;
  border: 2px solid var(--border);
  border-radius: 0.25rem;
  cursor: pointer;
  transition: border-color 0.2s;
  margin: 0 0 0 0.5rem;
  padding: 0;
}

.color-btn:hover,
.color-btn.active {
  border-color: var(--accent);
}

.brush-size {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.brush-size label {
  white-space: nowrap;
}

.brush-size input {
  width: 100px;
  vertical-align: middle;
}

#brush-size-value {
  width: 2rem;
  min-width: 2rem;
  text-align: center;
  display: inline-block;
}

.drawing-canvas {
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  cursor: crosshair;
  display: block;
  touch-action: none;
  margin: 0 auto;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.js": "import './index.css';
import './drawing.css';
import {app} from './app';
addEventListener('load', app);
",
}
`;

exports[`create-tinybase > ts-react-basic > should match snapshot 1`] = `
{
  "README.md": "# test-ts-react-basic

A TinyBase app built with TypeScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Demo</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A simple TinyBase app with key-values and tables mutated with
              buttons. See the full set of
              <a href="https://tinybase.org/demos/" target="_blank"
                >TinyBase demos</a
              >
              for more examples. <br /><br />
              Built with TypeScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-react-basic",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3",
    "@types/react": "^19.2.7",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.tsx": "import {StrictMode} from 'react';
import {createStore} from 'tinybase';
import {Provider, useCreateStore} from 'tinybase/ui-react';
import {SortedTableInHtmlTable, ValuesInHtmlTable} from 'tinybase/ui-react-dom';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Buttons} from './Buttons';

export const App = () => {
  const store = useCreateStore(() => {
    // Create the TinyBase Store and initialize the Store's data
    return createStore()
      .setValue('counter', 0)
      .setRow('pets', '0', {name: 'fido', species: 'dog'})
      .setTable('species', {
        dog: {price: 5},
        cat: {price: 4},
        fish: {price: 2},
        worm: {price: 1},
        parrot: {price: 3},
      });
  });

  return (
    <StrictMode>
      <Provider store={store}>
        <Buttons />
        <div>
          <h2>Values</h2>
          <ValuesInHtmlTable />
        </div>
        <div>
          <h2>Pets Table</h2>
          <SortedTableInHtmlTable
            tableId="pets"
            cellId="name"
            limit={5}
            sortOnClick={true}
            className="sortedTable"
            paginator={true}
          />
        </div>
        <Inspector />
      </Provider>
    </StrictMode>
  );
};
",
  "src/Buttons.tsx": "import {useAddRowCallback, useSetValueCallback} from 'tinybase/ui-react';
import type {ValueOrUndefined} from 'tinybase';

import {Button} from './components/Button';

// Convenience function for generating a random integer
const getRandom = (max = 100) => Math.floor(Math.random() * max);

export const Buttons = () => {
  // Attach events to the buttons to mutate the data in the TinyBase Store
  const handleCount = useSetValueCallback(
    'counter',
    () => (value: ValueOrUndefined) => ((value ?? 0) as number) + 1,
  );
  const handleRandom = useSetValueCallback('random', () => getRandom());
  const handleAddPet = useAddRowCallback('pets', (_, store) => ({
    name: ['fido', 'felix', 'bubbles', 'lowly', 'polly'][getRandom(5)],
    species: store.getRowIds('species')[getRandom(5)],
  }));

  return (
    <div id="buttons">
      <Button onClick={handleCount}>Increment number</Button>
      <Button onClick={handleRandom}>Random number</Button>
      <Button onClick={handleAddPet}>Add a pet</Button>
    </div>
  );
};
",
  "src/basic.css": "#buttons {
  border: solid #666;
  border-width: 1px 0;
  text-align: center;
  padding: 1rem 0;
}

table {
  border-collapse: collapse;
  font-size: inherit;
  line-height: inherit;
  margin-top: 0.5rem;
  table-layout: fixed;
  width: 100%;
  margin-bottom: 2rem;
  caption-side: bottom;
}
table caption {
  text-align: left;
  button {
    border: 0;
    margin-right: 0.25rem;
  }
}
table caption button {
  line-height: 0.7rem;
  margin: 0 0.25rem 0 0;
  vertical-align: middle;
}
th,
td {
  padding: 0.25rem 0.5rem 0.25rem 0;
  text-align: left;
}
thead th,
thead td {
  border: solid #999;
  border-width: 1px 0;
}
tbody th,
tbody td {
  border-bottom: 1px solid #333;
}

table.sortedTable thead th {
  cursor: pointer;
}

@media (min-width: 50rem) {
  #app {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
  }
  #buttons {
    grid-column: span 2;
  }
}
",
  "src/components/Button.tsx": "import './button.css';
import {ReactNode} from 'react';

interface ButtonProps {
  children: ReactNode;
  onClick: () => void;
  variant?: 'default' | 'primary';
}

export const Button = ({
  children,
  onClick,
  variant = 'default',
}: ButtonProps) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : undefined}
  >
    {children}
  </button>
);
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.tsx": "import './index.css';
import './basic.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';

addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')!).render(<App />),
);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > ts-react-chat > should match snapshot 1`] = `
{
  "README.md": "# test-ts-react-chat

A TinyBase app built with TypeScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Chat</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A real-time chat application demonstrating TinyBase's reactive
              data management.
              <br /><br />
              Built with TypeScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-react-chat",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3",
    "@types/react": "^19.2.7",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.tsx": "import {StrictMode, useState, useMemo} from 'react';
import {createStore} from 'tinybase';
import {
  Provider,
  useCreateStore,
  useAddRowCallback,
  useRow,
  useSetValueCallback,
  useValue,
  useRowIds,
  useStore,
} from 'tinybase/ui-react';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Button} from './components/Button';

const MessageInput = () => {
  const [message, setMessage] = useState('');
  const username = useValue('username') || 'Anonymous';

  const handleSend = useAddRowCallback(
    'messages',
    () => ({
      username,
      text: message,
      timestamp: Date.now(),
    }),
    [message, username],
  );

  const onSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (message.trim()) {
      handleSend();
      setMessage('');
    }
  };

  return (
    <form onSubmit={onSubmit} className="message-input">
      <input
        type="text"
        value={message}
        onChange={(e) => setMessage(e.target.value)}
        placeholder="Type a message..."
        autoFocus
      />
      <Button onClick={() => handleSend()} variant="primary">
        Send
      </Button>
    </form>
  );
};

const Message = ({rowId}: {rowId: string}) => {
  const row = useRow('messages', rowId);
  const time = new Date((row as any).timestamp).toLocaleTimeString();

  return (
    <div className="message">
      <span className="username">{(row as any).username}:</span>
      <span className="text">{(row as any).text}</span>
      <span className="time">{time}</span>
    </div>
  );
};

const Messages = () => {
  const store = useStore();
  const messageIds = useRowIds('messages');

  const sortedIds = useMemo(() => {
    return [...messageIds].sort((a, b) => {
      const rowA = store.getRow('messages', a) as any;
      const rowB = store.getRow('messages', b) as any;
      return rowA.timestamp - rowB.timestamp;
    });
  }, [messageIds, store]);

  return (
    <div className="messages">
      {sortedIds.map((id) => (
        <Message key={id} rowId={id} />
      ))}
    </div>
  );
};

const UsernameInput = () => {
  const username = useValue('username') || '';
  const handleChange = useSetValueCallback(
    'username',
    (e: React.ChangeEvent<HTMLInputElement>) => e.target.value,
    [],
  );

  return (
    <div className="username-input">
      <label>Username:</label>
      <input
        type="text"
        value={username}
        onChange={handleChange}
        placeholder="Enter your name"
      />
    </div>
  );
};

export const App = () => {
  const store = useCreateStore(() => {
    return createStore()
      .setValue('username', 'User')
      .setTable('messages', {
        '1': {username: 'Alice', text: 'Hello!', timestamp: Date.now() - 60000},
        '2': {
          username: 'Bob',
          text: 'Hi there!',
          timestamp: Date.now() - 30000,
        },
      });
  });

  return (
    <StrictMode>
      <Provider store={store}>
        <UsernameInput />
        <Messages />
        <MessageInput />
        <Inspector />
      </Provider>
    </StrictMode>
  );
};
",
  "src/chat.css": ".username-input {
  margin-bottom: 1rem;
}

.username-input label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.username-input input {
  flex: 1;
  padding: 0.5rem;
  background: #222;
  border: 1px solid #666;
  border-radius: 0.25rem;
  color: #fff;
  font-family: inherit;
}

.messages {
  overflow-y: auto;
  padding: 1rem 0;
  height: 400px;
  margin-bottom: 1rem;
}

.message {
  margin-bottom: 0.75rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.message .username {
  font-weight: 800;
  color: #d81b60;
}

.message .text {
  flex: 1;
}

.message .time {
  font-size: 0.8rem;
  color: #666;
}

.message-input {
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid #666;
}

.message-input input {
  flex: 1;
  padding: 0.75rem;
  background: #222;
  border: none;
  color: #fff;
  font-family: inherit;
}
",
  "src/components/Button.tsx": "import './button.css';
import {ReactNode} from 'react';

interface ButtonProps {
  children: ReactNode;
  onClick: () => void;
  variant?: 'default' | 'primary';
}

export const Button = ({
  children,
  onClick,
  variant = 'default',
}: ButtonProps) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : undefined}
  >
    {children}
  </button>
);
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.tsx": "import './index.css';
import './chat.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';

addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')!).render(<App />),
);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > ts-react-drawing > should match snapshot 1`] = `
{
  "README.md": "# test-ts-react-drawing

A TinyBase app built with TypeScript and React.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript + React</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Drawing</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A collaborative drawing canvas showcasing TinyBase's state
              synchronization.
              <br /><br />
              Built with TypeScript + React.
            </div>
          </div>
        </div>
      </div>
      <div id="app"></div>
    </div>

    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-react-drawing",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3",
    "@types/react": "^19.2.7",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^4.3.4"
  },
  "dependencies": {
    "tinybase": "^7.3.1",
    "react": "^19.2.3",
    "react-dom": "^19.2.3"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/App.tsx": "import {StrictMode, useCallback, useEffect, useRef} from 'react';
import {createStore} from 'tinybase';
import {
  Provider,
  useAddRowCallback,
  useCreateStore,
  useDelTableCallback,
  useRow,
  useRowIds,
  useStore,
} from 'tinybase/ui-react';
import {Inspector} from 'tinybase/ui-react-inspector';
import {Button} from './components/Button';

const Canvas = () => {
  const canvasRef = useRef<HTMLCanvasElement>(null);
  const isDrawing = useRef(false);
  const store = useStore();
  const strokes = useRowIds('strokes');

  const addStroke = useAddRowCallback(
    'strokes',
    (e: MouseEvent | TouchEvent) => {
      const canvas = canvasRef.current;
      if (!canvas) return null;

      const rect = canvas.getBoundingClientRect();
      const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;
      const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;
      const brush = store.getRow('settings', 'brush') as any;

      return {
        x: clientX - rect.left,
        y: clientY - rect.top,
        color: brush.color,
        size: brush.size,
      };
    },
    [],
  );

  const draw = useCallback(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    strokes.forEach((id) => {
      const stroke = store.getRow('strokes', id) as any;
      if (stroke) {
        ctx.fillStyle = stroke.color;
        ctx.beginPath();
        ctx.arc(stroke.x, stroke.y, stroke.size, 0, Math.PI * 2);
        ctx.fill();
      }
    });
  }, [strokes, store]);

  useEffect(() => {
    draw();
  }, [draw]);

  const handleStart = (e: React.MouseEvent | React.TouchEvent) => {
    isDrawing.current = true;
    addStroke(e.nativeEvent);
  };

  const handleMove = (e: React.MouseEvent | React.TouchEvent) => {
    if (isDrawing.current) {
      addStroke(e.nativeEvent);
    }
  };

  const handleEnd = () => {
    isDrawing.current = false;
  };

  return (
    <canvas
      ref={canvasRef}
      width={600}
      height={400}
      className="drawing-canvas"
      onMouseDown={handleStart}
      onMouseMove={handleMove}
      onMouseUp={handleEnd}
      onMouseLeave={handleEnd}
      onTouchStart={handleStart}
      onTouchMove={handleMove}
      onTouchEnd={handleEnd}
    />
  );
};

const ColorPicker = () => {
  const colors = [
    '#d81b60',
    '#1976d2',
    '#388e3c',
    '#f57c00',
    '#7b1fa2',
    '#fff',
  ];
  const store = useStore();
  const currentBrush = useRow('settings', 'brush') as any;

  const setColor = (color: string) => {
    store.setRow('settings', 'brush', {...currentBrush, color});
  };

  return (
    <div className="color-picker">
      {colors.map((color) => (
        <button
          key={color}
          className="color-btn"
          style={{background: color}}
          onClick={() => setColor(color)}
        />
      ))}
    </div>
  );
};

const BrushSize = () => {
  const store = useStore();
  const currentBrush = useRow('settings', 'brush') as any;
  const size = currentBrush.size;

  const setSize = (e: React.ChangeEvent<HTMLInputElement>) => {
    store.setRow('settings', 'brush', {
      ...currentBrush,
      size: parseInt(e.target.value),
    });
  };

  return (
    <div className="brush-size">
      <label>Size:</label>
      <input type="range" min="1" max="50" value={size} onChange={setSize} />
      <span id="brush-size-value">{size}</span>
    </div>
  );
};

const ClearButton = () => {
  const clearCanvas = useDelTableCallback('strokes');
  return (
    <Button onClick={clearCanvas} variant="primary">
      Clear
    </Button>
  );
};

export const App = () => {
  const store = useCreateStore(() => {
    return createStore()
      .setRow('settings', 'brush', {color: '#d81b60', size: 5})
      .setTable('strokes', {});
  });

  return (
    <StrictMode>
      <Provider store={store}>
        <>
          <div className="drawing-controls">
            <ColorPicker />
            <BrushSize />
            <ClearButton />
          </div>
          <Canvas />
          <Inspector />
        </>
      </Provider>
    </StrictMode>
  );
};
",
  "src/components/Button.tsx": "import './button.css';
import {ReactNode} from 'react';

interface ButtonProps {
  children: ReactNode;
  onClick: () => void;
  variant?: 'default' | 'primary';
}

export const Button = ({
  children,
  onClick,
  variant = 'default',
}: ButtonProps) => (
  <button
    onClick={onClick}
    className={variant === 'primary' ? 'primary' : undefined}
  >
    {children}
  </button>
);
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/drawing.css": ".drawing-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: center;
  margin: 0 auto 1rem;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  justify-content: space-between;
  max-width: 600px;
}

.color-picker {
  display: flex;
  gap: 0;
  align-items: center;
}

.color-btn {
  width: 2rem;
  height: 2rem;
  border: 2px solid var(--border);
  border-radius: 0.25rem;
  cursor: pointer;
  transition: border-color 0.2s;
  margin: 0 0 0 0.5rem;
  padding: 0;
}

.color-btn:hover,
.color-btn.active {
  border-color: var(--accent);
}

.brush-size {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.brush-size label {
  white-space: nowrap;
}

.brush-size input {
  width: 100px;
  vertical-align: middle;
}

#brush-size-value {
  width: 2rem;
  min-width: 2rem;
  text-align: center;
  display: inline-block;
}

.drawing-canvas {
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  cursor: crosshair;
  display: block;
  touch-action: none;
  margin: 0 auto;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.tsx": "import './index.css';
import './drawing.css';
import ReactDOM from 'react-dom/client';
import {App} from './App';

addEventListener('load', () =>
  ReactDOM.createRoot(document.getElementById('app')!).render(<App />),
);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
  "vite.config.js": "import {defineConfig} from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react({
      jsxRuntime: 'automatic',
    }),
  ],
});
",
}
`;

exports[`create-tinybase > ts-vanilla-basic > should match snapshot 1`] = `
{
  "README.md": "# test-ts-vanilla-basic

A TinyBase app built with TypeScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Demo</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A simple TinyBase app with key-values and tables mutated with
              buttons. See the full set of
              <a href="https://tinybase.org/demos/" target="_blank"
                >TinyBase demos</a
              >
              for more examples. <br /><br />
              Built with TypeScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div id="buttons"></div>
        <details open>
          <summary>Values</summary>
          <pre id="valuesJson"></pre>
        </details>
        <details open>
          <summary>Tables</summary>
          <pre id="tablesJson"></pre>
        </details>
      </div>
    </div>

    <script type="module" src="/src/index.ts"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-vanilla-basic",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.ts": "import {createStore} from 'tinybase';
import {createButton} from './components/button';

const updateJson = (id: string, content: unknown) =>
  (document.getElementById(id)!.innerText = JSON.stringify(content, null, 2));

const getRandom = (max = 100) => Math.floor(Math.random() * max);

export const app = () => {
  const store = createStore();

  const buttonsContainer = document.getElementById('buttons')!;

  buttonsContainer.appendChild(
    createButton('Increment number', () =>
      store.setValue('counter', (value) => value + 1),
    ),
  );
  buttonsContainer.appendChild(
    createButton('Random number', () => store.setValue('random', getRandom())),
  );
  buttonsContainer.appendChild(
    createButton('Add a pet', () =>
      store.addRow('pets', {
        name: ['fido', 'felix', 'bubbles', 'lowly', 'polly'][getRandom(5)],
        species: store.getRowIds('species')[getRandom(5)],
      }),
    ),
  );

  store.addValuesListener(() => updateJson('valuesJson', store.getValues()));
  store.addTablesListener(() => updateJson('tablesJson', store.getTables()));

  store
    .setValue('counter', 0)
    .setRow('pets', '0', {name: 'fido', species: 'dog'})
    .setTable('species', {
      dog: {price: 5},
      cat: {price: 4},
      fish: {price: 2},
      worm: {price: 1},
      parrot: {price: 3},
    });
};
",
  "src/basic.css": "#buttons {
  border: solid #666;
  border-width: 1px 0;
  text-align: center;
  padding: 1rem 0;
}

table {
  border-collapse: collapse;
  font-size: inherit;
  line-height: inherit;
  margin-top: 0.5rem;
  table-layout: fixed;
  width: 100%;
  margin-bottom: 2rem;
  caption-side: bottom;
}
table caption {
  text-align: left;
  button {
    border: 0;
    margin-right: 0.25rem;
  }
}
table caption button {
  line-height: 0.7rem;
  margin: 0 0.25rem 0 0;
  vertical-align: middle;
}
th,
td {
  padding: 0.25rem 0.5rem 0.25rem 0;
  text-align: left;
}
thead th,
thead td {
  border: solid #999;
  border-width: 1px 0;
}
tbody th,
tbody td {
  border-bottom: 1px solid #333;
}

table.sortedTable thead th {
  cursor: pointer;
}

@media (min-width: 50rem) {
  #app {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
  }
  #buttons {
    grid-column: span 2;
  }
}
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.ts": "import './button.css';

export const createButton = (
  text: string,
  onClick: () => void,
  variant: 'default' | 'primary' = 'default',
): HTMLButtonElement => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.ts": "import './index.css';
import './basic.css';
import {app} from './app';

addEventListener('load', app);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
}
`;

exports[`create-tinybase > ts-vanilla-chat > should match snapshot 1`] = `
{
  "README.md": "# test-ts-vanilla-chat

A TinyBase app built with TypeScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Chat</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A real-time chat application demonstrating TinyBase's reactive
              data management.
              <br /><br />
              Built with TypeScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div class="username-input">
          <label>Username:</label>
          <input
            type="text"
            id="username-input"
            placeholder="Enter your name"
          />
        </div>
        <div class="messages" id="messages"></div>
        <div class="message-input">
          <input
            type="text"
            id="message-input"
            placeholder="Type a message..."
            autofocus
          />
        </div>
      </div>
    </div>

    <script type="module" src="/src/index.ts"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-vanilla-chat",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.ts": "import {createStore} from 'tinybase';
import {createButton} from './components/button';

const updateMessages = (store: any) => {
  const messages = document.getElementById('messages')!;
  const messageRows = store.getTable('messages');
  const sortedIds = Object.keys(messageRows).sort(
    (a, b) => messageRows[a].timestamp - messageRows[b].timestamp,
  );

  messages.innerHTML = sortedIds
    .map((id) => {
      const msg = messageRows[id];
      const time = new Date(msg.timestamp).toLocaleTimeString();
      return \`
<div class="message">
  <span class="username">\${msg.username}:</span>
  <span class="text">\${msg.text}</span>
  <span class="time">\${time}</span>
</div>
\`;
    })
    .join('');
};

export const app = () => {
  const store = createStore()
    .setValue('username', 'User')
    .setTable('messages', {
      '1': {username: 'Alice', text: 'Hello!', timestamp: Date.now() - 60000},
      '2': {username: 'Bob', text: 'Hi there!', timestamp: Date.now() - 30000},
    });

  const usernameInput = document.getElementById(
    'username-input',
  ) as HTMLInputElement;
  const messageInput = document.getElementById(
    'message-input',
  ) as HTMLInputElement;

  usernameInput!.value = store.getValue('username') as string;
  usernameInput!.addEventListener('input', () => {
    store.setValue('username', usernameInput!.value);
  });

  store.addValuesListener(() => {
    usernameInput!.value = store.getValue('username') as string;
  });

  const sendMessage = () => {
    const text = messageInput!.value.trim();
    if (text) {
      store.addRow('messages', {
        username: store.getValue('username'),
        text,
        timestamp: Date.now(),
      });
      messageInput!.value = '';
    }
  };

  const messageInputContainer = document.querySelector('.message-input')!;
  const sendButton = createButton('Send', sendMessage, 'primary');
  messageInputContainer.appendChild(sendButton);

  messageInput!.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });

  store.addTablesListener(() => updateMessages(store));
  updateMessages(store);
};
",
  "src/chat.css": ".username-input {
  margin-bottom: 1rem;
}

.username-input label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.username-input input {
  flex: 1;
  padding: 0.5rem;
  background: #222;
  border: 1px solid #666;
  border-radius: 0.25rem;
  color: #fff;
  font-family: inherit;
}

.messages {
  overflow-y: auto;
  padding: 1rem 0;
  height: 400px;
  margin-bottom: 1rem;
}

.message {
  margin-bottom: 0.75rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.message .username {
  font-weight: 800;
  color: #d81b60;
}

.message .text {
  flex: 1;
}

.message .time {
  font-size: 0.8rem;
  color: #666;
}

.message-input {
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid #666;
}

.message-input input {
  flex: 1;
  padding: 0.75rem;
  background: #222;
  border: none;
  color: #fff;
  font-family: inherit;
}
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.ts": "import './button.css';

export const createButton = (
  text: string,
  onClick: () => void,
  variant: 'default' | 'primary' = 'default',
): HTMLButtonElement => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.ts": "import './index.css';
import './chat.css';
import {app} from './app';

addEventListener('load', app);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
}
`;

exports[`create-tinybase > ts-vanilla-drawing > should match snapshot 1`] = `
{
  "README.md": "# test-ts-vanilla-drawing

A TinyBase app built with TypeScript and Vanilla JS.

## Getting Started

\`\`\`bash
npm install
npm run dev
\`\`\`

## Learn More

- [TinyBase Documentation](https://tinybase.org)
- [TinyBase Examples](https://tinybase.org/demos/)
",
  "index.html": "<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap"
    />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>TinyBase / TypeScript</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        --hue: 270;
        --fg: oklch(85% 0.01 var(--hue));
        --fg2: oklch(60% 0.01 var(--hue));
        --bg: oklch(20% 0.01 var(--hue));
        --bg2: oklch(25% 0.01 var(--hue));
        --border: oklch(30% 0.01 var(--hue));
        --bg-header: oklch(30% 0.008 var(--hue) / 0.5);
        --accent: #d81b60;
        color: var(--fg);
        background: var(--bg);
        font-family: 'Inter', sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      #appContainer {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      #topBar {
        background: var(--bg-header);
        border-bottom: 1px solid var(--border);
        box-shadow: 0 1px 2px 0 #0007;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(4px);
      }

      #topBarLogo {
        height: 2rem;
        width: 2rem;
        flex-shrink: 0;
      }

      #topBarTitle {
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        flex: 1;
      }

      #topBarInfo {
        position: relative;
      }

      #infoIcon {
        width: 1.25rem;
        height: 1.25rem;
        border: 2px solid var(--fg2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 800;
        color: var(--fg2);
        cursor: help;
        transition: all 0.2s;
        user-select: none;
      }

      #infoIcon:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      #infoIcon:hover #infoTooltip {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      #infoTooltip {
        position: absolute;
        right: 0;
        top: calc(100% + 0.5rem);
        background: var(--bg2);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        font-weight: 400;
        width: 20rem;
        white-space: normal;
        color: var(--fg);
        line-height: 1.5;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-0.25rem);
        transition: all 0.2s;
        pointer-events: none;
        box-shadow: 0 1px 2px 0 #0007;
      }

      #infoTooltip a {
        color: var(--fg);
        text-decoration: underline;
      }

      #infoTooltip::before {
        content: '';
        position: absolute;
        right: 0.75rem;
        top: -0.375rem;
        width: 0.75rem;
        height: 0.75rem;
        background: var(--bg2);
        border-left: 1px solid var(--border);
        border-top: 1px solid var(--border);
        transform: rotate(45deg);
      }

      #app {
        max-width: 60rem;
        width: 100%;
        margin: 0 auto;
        padding: 2rem 1.5rem;
      }
    </style>
  </head>

  <body>
    <div id="appContainer">
      <div id="topBar">
        <img src="/favicon.svg" id="topBarLogo" alt="TinyBase" />
        <div id="topBarTitle">TinyBase Drawing</div>
        <div id="topBarInfo">
          <div id="infoIcon">
            i
            <div id="infoTooltip">
              A collaborative drawing canvas showcasing TinyBase's state
              synchronization.
              <br /><br />
              Built with TypeScript.
            </div>
          </div>
        </div>
      </div>
      <div id="app">
        <div class="drawing-controls">
          <div class="color-picker" id="color-picker"></div>
          <div class="brush-size">
            <label>Size:</label>
            <input type="range" id="brush-size" min="1" max="50" value="5" />
            <span id="brush-size-value">5</span>
          </div>
        </div>
        <canvas
          id="drawing-canvas"
          class="drawing-canvas"
          width="600"
          height="400"
        ></canvas>
      </div>
    </div>

    <script type="module" src="/src/index.ts"></script>
  </body>
</html>
",
  "package.json": "{
  "name": "test-ts-vanilla-drawing",
  "version": "1.0.0",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.1.3",
    "typescript": "^5.9.3",
    "@types/node": "^25.0.3"
  },
  "dependencies": {
    "tinybase": "^7.3.1"
  }
}
",
  "public/favicon.svg": "<svg viewBox="0 0 680 680" xmlns="http://www.w3.org/2000/svg" style="width:680px;height:680px">
  <path stroke="#fff" stroke-width="80" fill="none"
    d="M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
  <path fill="#d81b60"
    d="M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z" />
  <path
    d="M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z" />
</svg>",
  "src/app.ts": "import {createStore} from 'tinybase';
import {createButton} from './components/button';

export const app = () => {
  const store = createStore()
    .setRow('settings', 'brush', {color: '#d81b60', size: 5})
    .setTable('strokes', {});

  const canvas = document.getElementById('drawing-canvas') as HTMLCanvasElement;
  const ctx = canvas!.getContext('2d')!;
  let isDrawing = false;

  const draw = () => {
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, canvas!.width, canvas!.height);

    const strokes = store.getTable('strokes');
    Object.values(strokes).forEach((stroke: any) => {
      ctx.fillStyle = stroke.color;
      ctx.beginPath();
      ctx.arc(stroke.x, stroke.y, stroke.size, 0, Math.PI * 2);
      ctx.fill();
    });
  };

  const addStroke = (e: MouseEvent | TouchEvent) => {
    const rect = canvas!.getBoundingClientRect();
    const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;
    const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;
    const brush = store.getRow('settings', 'brush') as any;

    store.addRow('strokes', {
      x: clientX - rect.left,
      y: clientY - rect.top,
      color: brush.color,
      size: brush.size,
    });
  };

  canvas!.addEventListener('mousedown', () => {
    isDrawing = true;
  });
  canvas!.addEventListener('mouseup', () => {
    isDrawing = false;
  });
  canvas!.addEventListener('mouseleave', () => {
    isDrawing = false;
  });

  canvas!.addEventListener('mousemove', (e) => {
    if (isDrawing) addStroke(e);
  });

  canvas!.addEventListener('touchstart', (e) => {
    isDrawing = true;
    e.preventDefault();
  });

  canvas!.addEventListener('touchmove', (e) => {
    if (isDrawing) {
      addStroke(e);
      e.preventDefault();
    }
  });

  canvas!.addEventListener('touchend', () => {
    isDrawing = false;
  });

  // Color buttons
  const colors = [
    '#d81b60',
    '#1976d2',
    '#388e3c',
    '#f57c00',
    '#7b1fa2',
    '#fff',
  ];
  colors.forEach((color) => {
    const btn = document.createElement('button');
    btn.className = 'color-btn';
    btn.style.background = color;
    btn.addEventListener('click', () => {
      const brush = store.getRow('settings', 'brush') as any;
      store.setRow('settings', 'brush', {...brush, color});
    });
    document.getElementById('color-picker')!.appendChild(btn);
  });

  // Size slider
  const sizeSlider = document.getElementById('brush-size') as HTMLInputElement;
  const sizeLabel = document.getElementById('brush-size-value')!;

  sizeSlider!.addEventListener('input', () => {
    const brush = store.getRow('settings', 'brush') as any;
    const size = parseInt(sizeSlider!.value);
    store.setRow('settings', 'brush', {...brush, size});
    sizeLabel.textContent = \`\${size}\`;
  });

  // Clear button
  const clearButton = createButton(
    'Clear',
    () => store.delTable('strokes'),
    'primary',
  );
  document.querySelector('.drawing-controls')!.appendChild(clearButton);

  store.addTablesListener(draw);
  draw();
};
",
  "src/components/button.css": "button {
  padding: 0.5rem 1rem;
  border: 1px solid #666;
  border-radius: 0.25rem;
  background: #222;
  color: #fff;
  font-family: inherit;
  font-weight: 800;
  cursor: pointer;
  margin: 0.5rem;
}

button:hover {
  border-color: #d81b60;
}

button.primary {
  background: #d81b60;
  border: none;
  padding: 0.75rem 1.5rem;
}

button.primary:hover {
  background: #c2185b;
}
",
  "src/components/button.ts": "import './button.css';

export const createButton = (
  text: string,
  onClick: () => void,
  variant: 'default' | 'primary' = 'default',
): HTMLButtonElement => {
  const button = document.createElement('button');
  button.textContent = text;
  if (variant === 'primary') {
    button.className = 'primary';
  }
  button.addEventListener('click', onClick);
  return button;
};
",
  "src/drawing.css": ".drawing-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: center;
  margin: 0 auto 1rem;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  justify-content: space-between;
  max-width: 600px;
}

.color-picker {
  display: flex;
  gap: 0;
  align-items: center;
}

.color-btn {
  width: 2rem;
  height: 2rem;
  border: 2px solid var(--border);
  border-radius: 0.25rem;
  cursor: pointer;
  transition: border-color 0.2s;
  margin: 0 0 0 0.5rem;
  padding: 0;
}

.color-btn:hover,
.color-btn.active {
  border-color: var(--accent);
}

.brush-size {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.brush-size label {
  white-space: nowrap;
}

.brush-size input {
  width: 100px;
  vertical-align: middle;
}

#brush-size-value {
  width: 2rem;
  min-width: 2rem;
  text-align: center;
  display: inline-block;
}

.drawing-canvas {
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  cursor: crosshair;
  display: block;
  touch-action: none;
  margin: 0 auto;
}
",
  "src/index.css": "a {
  color: var(--fg);
}

h1 {
  font-weight: 600;
  img {
    margin-right: 1rem;
    height: 2.5rem;
    vertical-align: text-bottom;
  }
}

h2 {
  font-weight: 800;
  font-size: 1.3rem;
  margin: 1rem 0 0;
}

p {
  margin: 0 0 1rem;
  line-height: 1.5;
}

details {
  border: 1px solid var(--border);
  border-radius: 0.25rem;
  padding: 0.5rem;
}

details summary {
  cursor: pointer;
  font-weight: 800;
  margin: -0.5rem -0.5rem 0;
  padding: 0.5rem;
}

details[open] summary {
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}
",
  "src/index.ts": "import './index.css';
import './drawing.css';
import {app} from './app';

addEventListener('load', app);
",
  "tsconfig.json": "{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
",
}
`;
