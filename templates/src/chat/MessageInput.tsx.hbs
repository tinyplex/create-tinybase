{{includeFile template="src/chat/messageInput.css.hbs" output="src/chat/messageInput.css"}}
import {useState} from 'react';
import {useAddRowCallback, useValue} from 'tinybase/ui-react';
import './messageInput.css';
{{includeFile template="src/shared/Button.tsx.hbs" output="src/shared/Button.{{ext}}"}}
import {Button} from '../shared/Button';
{{includeFile template="src/shared/Input.tsx.hbs" output="src/shared/Input.{{ext}}"}}
import {Input} from '../shared/Input';

export const MessageInput = () => {
const [message, setMessage] = useState('');
const username = useValue('username', 'settings') || 'Anonymous';

const handleSend = useAddRowCallback(
'messages',
() => ({
username,
text: message,
timestamp: Date.now(),
}),
[message, username],
'chat',
);

const onSubmit = (e: React.FormEvent) => {
e.preventDefault();
if (message.trim()) {
handleSend();
setMessage('');
}
};

return (
<form onSubmit={onSubmit} id="messageInput">
  <Input value={message} onChange={setMessage} placeholder="Type a message..." autoFocus />
  <Button type="submit" variant="primary">Send</Button>
</form>
);
};