{{includeFile template="src/components/messageInput.css.hbs" output="src/components/messageInput.css"}}
import {useState} from 'react';
import {useAddRowCallback, useValue} from 'tinybase/ui-react';
import './messageInput.css';
{{includeFile template="src/components/Button.tsx.hbs" output="src/components/Button.{{ext}}"}}
import {Button} from './Button';
{{includeFile template="src/components/Input.tsx.hbs" output="src/components/Input.{{ext}}"}}
import {Input} from './Input';

export const MessageInput = () => {
const [message, setMessage] = useState('');
const username = useValue('username') || 'Anonymous';

const handleSend = useAddRowCallback(
'messages',
() => ({
username,
text: message,
timestamp: Date.now(),
}),
[message, username],
);

const onSubmit = (e: React.FormEvent) => {
e.preventDefault();
if (message.trim()) {
handleSend();
setMessage('');
}
};

return (
<form onSubmit={onSubmit} id="messageInput">
  <Input value={message} onChange={setMessage} placeholder="Type a message..." autoFocus />
  <Button type="submit" variant="primary">Send</Button>
</form>
);
};
