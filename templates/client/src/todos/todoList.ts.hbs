{{includeFile template="client/src/todos/todoList.css.hbs" output="client/src/todoList.css"}}
{{addImport "import './todoList.css';"}}
{{addImport "import {type TodosStore, type TodoRow} from './store';"}}
{{includeFile template="client/src/todos/todoItem.ts.hbs" output="client/src/todoItem.{{ext}}"}}
{{addImport "import {createTodoItem} from './todoItem';"}}

export const createTodoList = (store: TodosStore): HTMLDivElement => {
const list = document.createElement('div');
list.id = 'todoList';

const render = () => {
const todoIds = store.getSortedRowIds('todos');

list.innerHTML = '';
todoIds.forEach((id) => {
const todo = store.getRow('todos', id) as TodoRow;
const item = createTodoItem(
id,
todo.text,
todo.completed,
() => {
store.setPartialRow('todos', id, {completed: !todo.completed});
},
() => {
store.delRow('todos', id);
}
);
list.appendChild(item);
});
};

store.addTablesListener(render);
render();

return list;
};