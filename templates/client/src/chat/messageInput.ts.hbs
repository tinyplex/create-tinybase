{{includeFile template="client/src/chat/messageInput.css.hbs" output="client/src/messageInput.css"}}
import './messageInput.css';
import {type SettingsStore} from './settingsStore';
import {type ChatStore} from './chatStore';

{{includeFile template="client/src/shared/button.ts.hbs" output="client/src/button.{{ext}}"}}
import {createButton} from './button';

{{includeFile template="client/src/shared/input.ts.hbs" output="client/src/input.{{ext}}"}}
import {createInput} from './input';

export const createMessageInput = (settingsStore: SettingsStore, chatStore: ChatStore): HTMLDivElement => {
const messageInputContainer = document.createElement('div');
messageInputContainer.id = 'messageInput';

const messageInput = createInput('Type a message...');
messageInputContainer.appendChild(messageInput);

const sendMessage = () => {
const text = messageInput.value.trim();
if (text) {
chatStore.addRow('messages', {
username: settingsStore.getValue('username'),
text,
timestamp: Date.now(),
});
messageInput.value = '';
messageInput.focus();
}
};

messageInput.addEventListener('keypress', (e) => {
if (e.key === 'Enter') {
sendMessage();
}
});

const sendButton = createButton('Send', sendMessage, 'primary');
messageInputContainer.appendChild(sendButton);

return messageInputContainer;
};
