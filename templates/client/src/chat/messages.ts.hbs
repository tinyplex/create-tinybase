{{includeFile template="client/src/chat/messages.css.hbs" output="client/src/messages.css"}}
{{addImport "import './messages.css';"}}
{{addImport "import {type ChatStore, type MessageRow} from './chatStore';"}}

{{includeFile template="client/src/chat/message.ts.hbs" output="client/src/message.{{ext}}"}}
{{addImport "import {createMessage} from './message';"}}

export const createMessages = (store: ChatStore): HTMLDivElement => {
const messagesContainer = document.createElement('div');
messagesContainer.id = 'messages';

const updateMessages = () => {
const sortedIds = store.getSortedRowIds('messages', 'timestamp');

messagesContainer.innerHTML = '';
sortedIds.forEach((id) => {
const messageRow = store.getRow('messages', id) as MessageRow;
const messageElement = createMessage(messageRow);
messagesContainer.appendChild(messageElement);
});
};

updateMessages();

store.addTablesListener(updateMessages);

return messagesContainer;
};